<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文本生成器</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            width: 100%;
            max-width: 900px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            padding: 30px;
            margin: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }

        h1 {
            color: #2575fc;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #6a11cb;
            font-size: 1.2rem;
            font-weight: 500;
        }

        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
        }

        .options-section {
            flex: 1;
            min-width: 300px;
            background: #f8f9ff;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .result-section {
            flex: 1;
            min-width: 300px;
            display: flex;
            flex-direction: column;
        }

        .category {
            margin-bottom: 25px;
        }

        .category-title {
            font-size: 1.3rem;
            color: #2575fc;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px dashed #c2d6ff;
            display: flex;
            align-items: center;
        }

        .category-title i {
            margin-right: 10px;
            font-size: 1.2em;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 12px;
        }

        .option-item {
            display: flex;
            align-items: center;
        }

        .option-item input[type="checkbox"] {
            margin-right: 8px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .option-item label {
            cursor: pointer;
            font-size: 1rem;
            color: #444;
            transition: color 0.3s;
        }

        .option-item label:hover {
            color: #6a11cb;
            font-weight: 500;
        }

        .result-display {
            flex: 1;
            background: #f8f9ff;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            min-height: 250px;
        }

        .result-display h3 {
            color: #2575fc;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.4rem;
        }

        #generatedText {
            background: white;
            border-radius: 10px;
            padding: 20px;
            min-height: 180px;
            border: 1px solid #e0e6ff;
            font-size: 1.1rem;
            line-height: 1.6;
            color: #444;
            white-space: pre-wrap;
        }

        .actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            padding: 14px 30px;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        #generateBtn {
            background: linear-gradient(to right, #6a11cb, #2575fc);
            color: white;
            box-shadow: 0 5px 15px rgba(37, 117, 252, 0.4);
        }

        #generateBtn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(37, 117, 252, 0.6);
        }

        #saveBtn {
            background: linear-gradient(to right, #00b09b, #96c93d);
            color: white;
            box-shadow: 0 5px 15px rgba(0, 176, 155, 0.4);
        }

        #saveBtn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 176, 155, 0.6);
        }

        #resetBtn {
            background: linear-gradient(to right, #ff416c, #ff4b2b);
            color: white;
            box-shadow: 0 5px 15px rgba(255, 65, 108, 0.4);
        }

        #resetBtn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 65, 108, 0.6);
        }

        footer {
            text-align: center;
            margin-top: 30px;
            color: #777;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }

            h1 {
                font-size: 2rem;
            }

            button {
                padding: 12px 20px;
                font-size: 1rem;
            }
        }

        .form-container {
            width: 100%;
        }

        h2 {
            color: var(--main-color);
            margin: 0 0 0.5rem 0;
            border-left: 4px solid var(--accent-color);
            padding-left: 0.5rem;
        }

        form {
            display: flex;
            flex-direction: column;
        }

        .form-section {
            margin-bottom: 1.5rem;
        }

        .form-row {
            display: flex;
            align-items: center;
            margin-bottom: 0.8rem;
        }

        .form-row label {
            width: 120px;
            font-weight: bold;
        }

        .form-row input[type="text"],
        .form-row input[type="date"],
        .form-row input[type="time"],
        .form-row select {
            flex: 1;
            padding: 0.5rem;
            border: 1px solid #ccc;
            border-radius: 4px;
        }


        /* 固定於畫面下方的輸出容器 */
        .output-container {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #f7faff;
            border-top: 2px solid var(--accent-color);
            padding: 1rem;
            box-sizing: border-box;
            z-index: 999;
            max-height: 250px;
            overflow-y: auto;
        }

        /* 2×2 文字網格 */
        .text-grid {
            display: grid;
            grid-template-columns: 1fr 3fr;
            gap: 1rem;
            align-items: start;
        }

        .text-grid > div {
            background-color: #fff;
            padding: 0.5rem;
            border-radius: 4px;
        }

        #finalText {
            margin-top: 0.5rem;
        }
    </style>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>
<form class="container" id="container">
    <header>
        <h1>文本生成器</h1>
    </header>

    <div class="main-content">
        <div class="options-section">
            <div class="form-row">
                <label for="location">RN：</label>
                <input type="text" id="RN" name="RN" value="" placeholder="KT RN"/>
            </div>
            <div class="form-row">
                <label for="location">地點：</label>
                <input type="text" id="location" name="location" value=""/>
            </div>
            <div class="form-row">
                <label for="date">妥當時間：</label>
                <input type="date" id="correctdate" name="correctdate"/>
                <input type="time" id="correcttime" name="correcttime"/>
            </div>
            <div class="form-row">
                <label for="time">不精神時間：</label>
                <input type="date" id="incorrectdate" name="incorrectdate"/>
                <input type="time" id="incorrecttime" name="incorrecttime"/>
            </div>
            <div class="form-row">
                <label for="time">宣告死亡時間：</label>
                <input type="date" id="certifieddate" name="certifieddate"/>
                <input type="time" id="certifiedtime" name="certifiedtime"/>
            </div>
            <div class="form-row">
                <label for="doctor">醫生：</label>
                <input type="text" id="doctor" name="doctor" value=""/>
            </div>
            <div class="form-row">
                <label for="amb">救護車：</label>
                <input type="text" id="amb" name="amb" value=""/>
            </div>
            <div class="category">
                <div class="form-row">
                    <label>一家幾口：</label>
                    <input type="text" id="family0" name="family" value=""/>
                </div>
                <div class="options-grid">
                    <div class="option-item">
                        <input type="checkbox" id="family1" name="family" value="爸">
                        <label for="family1">爸</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="family2" name="family" value="媽">
                        <label for="family2">媽</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="family3" name="family" value="仔">
                        <label for="family3">仔</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="family4" name="family" value="女">
                        <label for="family4">女</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="family5" name="family" value="工人">
                        <label for="family5">工人</label>
                    </div>
                </div>
            </div>
            <div class="form-row">
                <label for="Living">入住年份：</label>
                <input type="date" id="Living" name="Living" value=""/>
            </div>
            <div class="form-row">
                <label for="Hospital">醫院/老人院床位：</label>
                <input type="text" id="Hospital" name="Hospital" value=""/>
            </div>
            <div class="category">
                <div class="category-title">
                    <i class="fas fa-clock"></i>
                    <span>病歷</span>
                </div>
                <div class="options-grid">
                    <div class="option-item">
                        <input type="checkbox" id="d1" name="decease" value="心臟病">
                        <label for="d1">心臟病</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="d2" name="decease" value="高血壓">
                        <label for="d2">高血壓</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="d3" name="decease" value="高膽固醇">
                        <label for="d3">高膽固醇</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="d4" name="decease" value="老人癡呆">
                        <label for="d4">老人癡呆</label>
                    </div>
                </div>
                <input type="text" id="decease" name="decease" value=""/>
            </div>

            <div class="category">
                <div class="category-title">
                    <i class="fas fa-cloud-sun"></i>
                    <span>長期服用藥物</span>
                </div>
                <div class="options-grid">
                    <div class="option-item">
                        <input type="checkbox" id="m1" name="medicine" value="血壓藥">
                        <label for="medicine1">血壓藥</label>
                    </div>
                    <input type="text" id="medicine" name="medicine" value=""/>
                </div>
            </div>
            <div class="form-row">
                <label for="MT">上次覆診日期地點：</label>
                <input type="date" id="MTdate" name="MTdate"/>
                <input type="text" id="MT" name="MT" value=""/>
            </div>
            <div class="form-row">
                <label for="HMT">上次入院日期地點：</label>
                <input type="date" id="HMTdate" name="HMTdate"/>
                <input type="text" id="HMT" name="HMT" value=""/>
            </div>
            <div class="form-row">
                <label for="HMT">手術種類(年份)：</label>
                <input type="date" id="surgerydate" name="surgerydate"/>
                <input type="text" id="surgery" name="surgery" value=""/>
            </div>
            <div class="category">
                <div class="category-title">
                    <i class="fas fa-running"></i>
                    <span>行動自如/坐輪椅/長期臥床：</span>
                </div>
                <div class="options-grid">
                    <div class="option-item">
                        <input type="checkbox" id="activity1" name="activity" value="行動自如">
                        <label for="activity1">行動自如</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="activity2" name="activity" value="坐輪椅">
                        <label for="activity2">坐輪椅</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="activity3" name="activity" value="長期臥床">
                        <label for="activity3">長期臥床</label>
                    </div>
                </div>
            </div>

            <div class="category">
                <div class="category-title">
                    <i class="fas fa-comment-dots"></i>
                    <span>食物</span>
                </div>
                <div class="options-grid">
                    <div class="option-item">
                        <input type="checkbox" id="food1" name="food" value="固體">
                        <label for="food1">固體</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="food2" name="food" value="流質">
                        <label for="food2">流質</label>
                    </div>
                </div>
            </div>
            <div class="category">
                <div class="category-title">
                    <i class="fas fa-comment-dots"></i>
                    <span>保險</span>
                </div>
                <div class="options-grid">
                    <div class="option-item">
                        <input type="text" id="insurance" name="insurance" value=""/>
                    </div>
                </div>
            </div>
            <div class="category">
                <div class="category-title">
                    <i class="fas fa-comment-dots"></i>
                    <span>綜援</span>
                </div>
                <div class="options-grid">
                    <div class="option-item">
                        <input type="text" id="allowance" name="allowance" value=""/>
                    </div>
                </div>
            </div>
            <div class="category">
                <div class="category-title">
                    <i class="fas fa-comment-dots"></i>
                    <span>辦事人</span>
                </div>
                <div class="options-grid">
                    <div class="option-item">
                        <div class="options-grid">
                            <div class="option-item">
                                <input type="checkbox" id="sex1" name="sex" value="M">
                                <label for="sex1">男</label>
                            </div>
                            <div class="option-item">
                                <input type="checkbox" id="sex2" name="sex" value="F">
                                <label for="sex2">女</label>
                            </div>

                        </div>
                        <div class="options-grid">
                            <div> <span></span>名字:</span><input type="text" id="PIC" name="PIC" value=""/></div>
                            <div> <span>TEL:</span><input type="text" id="PICtel" name="PICtel" value=""/></div>
                            <div> <span>職業:</span><input type="text" id="PICjob" name="PICjob" value=""/></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="result-section">
            <div class="result-display">
                <h3>生成的文本</h3>
                <div id="generatedText"></div>
            </div>

            <div class="actions">
                <button id="generateBtn">
                    <i class="fas fa-magic"></i>
                    <span>生成文本</span>
                </button>
                <button id="saveBtn">
                    <i class="fas fa-save"></i>
                    <span>保存文本</span>
                </button>
                <button id="resetBtn">
                    <i class="fas fa-redo"></i>
                    <span>重置选项</span>
                </button>
            </div>
        </div>
    </div>
</form>
<footer>
    <p>文本生成器 &copy; 2023 | 选择选项创建自定义内容</p>
</footer>

<script>
    const RNInput = document.getElementById("RN");
    const locationInput = document.getElementById("location");
    const correctdateInput = document.getElementById("correctdate");
    const correcttimeInput = document.getElementById("correcttime");
    const incorrectdateInput = document.getElementById("incorrectdate");
    const incorrecttimeInput = document.getElementById("incorrecttime");
    const certifieddateInput = document.getElementById("certifieddate");
    const certifiedtimeInput = document.getElementById("certifiedtime");
    const familyInput = document.getElementById("family0");
    const doctorInput = document.getElementById("doctor");
    const ambInput = document.getElementById("amb");
    const Hospital = document.getElementById("Hospital");
    const medicineInput = document.getElementById("medicine");
    const deceaseInput = document.getElementById("decease");
    const MTdateInput = document.getElementById("MTdate");
    const MTInput = document.getElementById("MT");
    const HMTdateInput = document.getElementById("HMTdate");
    const HMTInput = document.getElementById("HMT");
    const surgerydateInput = document.getElementById("surgerydate");
    const surgeryInput = document.getElementById("surgery");
    const insuranceInput = document.getElementById("insurance");
    const allowanceInput = document.getElementById("allowance");
    const PICInput = document.getElementById("PIC");
    const PICjobInput = document.getElementById("PICjob");
    const PICtelInput = document.getElementById("PICtel");

    const form = document.getElementById("container");
    //document.addEventListener('DOMContentLoaded', function () {

        const generateBtn = document.getElementById('generateBtn');
        const saveBtn = document.getElementById('saveBtn');
        const resetBtn = document.getElementById('resetBtn');
        const generatedText = document.getElementById('generatedText');
        generateBtn.addEventListener('click',updateform);
        // 生成文本函数
        function updateform() {
            // 获取所有选中的选项
            const family = getSelectedValues('family');
            const Living = document.getElementById('Living');
            const decease = getSelectedValues('decease');
            const medicine = getSelectedValues('medicine');
            const activity = getSelectedValues('activity');
            const food = getSelectedValues('food');
            const sex = getSelectedValues('sex');
            // 构建文本

            let text = '';
            if (RNInput.value.length > 0) {
                text += 'KT RN ' + RNInput.value + '\n';
            } else {
                text += 'KT RN :Nil\n';
            }
            if (locationInput.value.length > 0) {
                text += '地址：' + locationInput.value + '\n';
            } else {
                text += '地址：Nil\n';
            }
            if (correctdateInput.value.length > 0 || correcttimeInput.value.length > 0) {
                text += '妥當時間：' + correctdateInput.value + ' ' + correcttimeInput.value + 'hrs\n';
            } else {
                text += '妥當時間：Nil\n';
            }
            if (incorrectdateInput.value.length > 0 || incorrecttimeInput.value.length > 0) {
                text += '不精神時間：' + incorrectdateInput.value + ' ' + incorrecttimeInput.value + 'hrs\n';
            } else {
                text += '不精神時間：Nil\n';
            }
            if (certifieddateInput.value.length > 0 || certifiedtimeInput.value.length > 0) {
                text += '死亡時間：' + certifieddateInput.value + ' ' + certifiedtimeInput.value + 'hrs\n';
            } else {
                text += '死亡時間： Nil\n';
            }
            if (doctorInput.value.length > 0) {
                text += '由醫生 Dr.' + doctorInput.value + '\n';
            } else {
                text += '由醫生 Dr. : Nil\n';
            }
            if (ambInput.value.length > 0) {
                text += '救護車: A ' + ambInput.value + '\n\n\n\n';
            } else {
                text += '救護車: A Nil\n\n\n\n';
            }

            if (family.length > 0 || familyInput.value.length > 0) {
                text += '一家' + familyInput.value + '口:(' + family.join(',') + ')\n';
            } else {
                text += '一家幾口：Nil\n';
            }
            if (Living.value.length > 0) {
                text += '入住年份：' + Living.value + '\n';
            } else {
                text += '入住年份：Nil\n';
            }
            if (Hospital.value.length > 0) {
                text += '醫院/老人院床位：' + Hospital.value + '\n';
            } else {
                text += '醫院/老人院床位：Nil\n\n';
            }
            if (decease.length > 0) {
                text += '病歷(年份)：' + decease.join(',') + ',' + deceaseInput.value + '\n';
            } else {
                text += '病歷(年份)：Nil\n';
            }
            if (medicine.length > 0) {
                text += '長期服用藥物：' + medicine.join(',') + ',' + medicineInput.value + '\n';
            } else {
                text += '長期服用藥物：Nil\n';
            }
            if (MTdateInput.value.length > 0 || MTInput.value.length > 0) {
                text += '上次覆診日期地點：' + MTdateInput.value + MTInput.value + '\n';
            } else {
                text += '上次覆診日期地點：Nil\n';
            }
            if (HMTdateInput.value.length > 0 || HMTInput.value.length > 0) {
                text += '最近入院日期原因：' + HMTdateInput.value + HMTInput.value + '\n';
            } else {
                text += '最近入院日期原因：Nil\n';
            }
            if (surgerydateInput.value.length > 0 || surgeryInput.value.length > 0) {
                text += '手術種類(年份)：' + surgerydateInput.value + surgeryInput.value + '\n';
            } else {
                text += '手術種類(年份)：Nil\n';
            }
            if (activity.length > 0) {
                text += '行動自如/坐輪椅/長期臥床：' + activity.join(',') + '\n';
            } else {
                text += '行動自如/坐輪椅/長期臥床：Nil\n';
            }
            if (food.length > 0) {
                text += '食固體/流質食物：' + food.join(',') + '\n';
            } else {
                text += '食固體/流質食物：Nil\n';
            }
            if (insuranceInput.value.length > 0) {
                text += '保險：' + insuranceInput.value + '\n';
            } else {
                text += '保險：Nil\n';
            }
            if (allowanceInput.value.length > 0) {
                text += '綜援：' + allowanceInput.value + '\n';
            } else {
                text += '綜援：Nil\n\n\n\n認領遺體：';
            }
            if (PICInput.value.length > 0 || sex.length > 0 || PICjobInput.value.length > 0 || PICtelInput.value.length > 0) {
                text += '家屬：' + sex.join(',') + '/' + PICInput.value + '\n';
                text += '職業：' +PICjobInput.value + '\n';
                text += 'Tel：' +PICtelInput.value + '\n';
            } else {
                text += '家屬：Nil\n';
            }
            //alert(text);
            if (text === '') {
                generatedText.textContent = 'error';
                generatedText.style.color = '#ff416c';
            } else {
                //alert(text);
                generatedText.textContent = text;
                generatedText.style.color = '#444';
            }

        }

        // 保存文本函数
        saveBtn.addEventListener('click', function () {
            const text = generatedText.textContent;
            if (text === '请选择选项后点击"生成文本"按钮' || text === '请至少选择一个选项' || text === '') {
                alert('请先生成有效的文本内容');
                return;
            }

            const blob = new Blob([text], {type: 'text/plain;charset=utf-8'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'custom_text.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            // 显示保存成功消息
            const originalText = generatedText.textContent;
            generatedText.textContent = '文本已保存为 custom_text.txt';
            generatedText.style.color = '#00b09b';

            setTimeout(() => {
                generatedText.textContent = originalText;
                generatedText.style.color = '#444';
            }, 1000);
        });
//alert('text');
        // 重置选项函数
        resetBtn.addEventListener('click', function () {
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                checkbox.checked = false;
            });
            generatedText.textContent = '请选择选项后点击"生成文本"按钮';
            generatedText.style.color = '#777';
        });

        // 辅助函数：获取选中的值
        function getSelectedValues(name) {
            const checkboxes = document.querySelectorAll(`input[name="${name}"]:checked`);
            return Array.from(checkboxes).map(cb => cb.value);
        }

    // 為時間字串加上指定分鐘 (24 小時格式)
    const addMinutesToTime = (timeStr, minutesToAdd) => {
        if (!timeStr) return "";
        const [hh, mm] = timeStr.split(":").map(Number);
        const total = hh * 60 + mm + minutesToAdd;
        const newH = Math.floor(total / 60) % 24;
        const newM = total % 60;
        return `${String(newH).padStart(2, '0')}:${String(newM).padStart(2, '0')}`;
    };
    // 設定「日期」為今日
    const setTodayDate = () => {
        correctdateInput.value = new Date().toISOString().slice(0, 10);
        incorrectdateInput.value = new Date().toISOString().slice(0, 10);
        certifieddateInput.value = new Date().toISOString().slice(0, 10);
    };
    // 設定「時間」為目前時分
    const setCurrentTime = () => {
        const now = new Date();
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        correcttimeInput.value = `${hours}:${minutes}`;
        incorrecttimeInput.value = `${hours}:${minutes}`;
        certifiedtimeInput.value = `${hours}:${minutes}`;
    };

        // 防止表單提交導致頁面重整
    form.addEventListener("submit", e => e.preventDefault());
    // 表單輸入時即時更新
    form.addEventListener("input", updateform);
    setTodayDate();
      setCurrentTime();
</script>
</body>
</html>
